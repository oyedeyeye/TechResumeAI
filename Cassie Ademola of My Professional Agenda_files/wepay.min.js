"use strict";var WePay=window.WePay=WePay||{};WePay.PRODUCTION_ENDPOINT="https://api.wepay.com",WePay.STAGING_ENDPOINT="https://stage-api.wepay.com",WePay.PRODUCTION_UPLOAD_ENDPOINT="https://uploads.wepay.com",WePay.STAGING_UPLOAD_ENDPOINT="https://stage-uploads.wepay.com",WePay.PRODUCTION_IFRAME_ENDPOINT="https://iframe.wepay.com",WePay.STAGE_IFRAME_ENDPOINT="https://stage-iframe.wepay.com",WePay.configure=WePay.configure||function(e,r,t,n){var o=WePay._internal.validateSDKConfiguration(e,r,t);if(o.hasError())return o.buildInvalidParams();WePay._internal.setEnvironment(e),WePay._internal.setAppID(r),WePay._internal.setAPIVersion(t),WePay._internal.setSessionToken(n),WePay._internal.generate_risk_token_delayed()};var isIe11=!!window.MSInputMethodContext&&!!document.documentMode;if(isIe11){var script=document.createElement("script");script.src="https://cdn.wepay.com/bluebird.min.js",document.head.appendChild(script)}WePay.createCreditCardIframe=WePay.createCreditCardIframe||function(e,r){r=r||{};var t=WePay._internal.validateSDKIsConfigured();if(t.hasError())return t.buildSDKConfigurationError();var n=new WePay._internal.errorCollection;if("string"!=typeof e&&n.addWrongStringTypeError("iframe_container_id",e),document.getElementById(e)||n.addIDNotFoundError("iframe_container_id",e),"object"!=typeof r)n.addWrongObjectTypeError("options",r);else for(var o in r)r.hasOwnProperty(o)&&WePay._internal.allowOptions(o,["custom_style","show_labels","show_placeholders","show_error_messages","show_error_messages_when_unfocused","use_one_liner","show_error_icon","show_required_asterisk","resize_on_error_message","custom_required_field_error_message"]);if(n.hasError())return n.buildInvalidParams();var i="76px";if(WePay._internal.checkNested(r,"custom_style","styles","base","height")){var a=r.custom_style.styles.base.height;if(a){var s=a.split("px")[0];isNaN(s)||(i=2*s+10+"px")}}var d=new WePay._internal.iframe;return d.init(e,r,{iframe_route:"/paymentMethods/creditCard/v3",initial_height:i,sandbox_enabled:!0,sandbox_attributes:"allow-forms allow-scripts allow-same-origin"}),delete d.test,d},WePay.createGooglePayIframe=WePay.createGooglePayIframe||function(e,r){var t=r||{},n=WePay._internal.validateSDKIsConfigured();if(n.hasError())return n.buildSDKConfigurationError();var o=new WePay._internal.errorCollection;if("string"!=typeof e&&o.addWrongStringTypeError("iframe_container_id",e),document.getElementById(e)||o.addIDNotFoundError("iframe_container_id",e),"object"!=typeof t)o.addWrongObjectTypeError("iframeConfigs",t);else for(var i in t)t.hasOwnProperty(i)&&WePay._internal.allowOptions(i,["button_configs","on_success","on_error","on_update_payment_data"]);if(t.button_configs)if("object"!=typeof t.button_configs)o.addWrongObjectTypeError("button_configs",t.button_configs);else if(t.button_configs.paymentRequest)if("object"!=typeof t.button_configs.paymentRequest)o.addWrongObjectTypeError("button_configs.paymentRequest",t.button_configs.paymentRequest);else if(t.button_configs.paymentRequest.transactionInfo)if("object"!=typeof t.button_configs.paymentRequest.transactionInfo)o.addWrongObjectTypeError("button_configs.paymentRequest.transactionInfo",t.button_configs.paymentRequest.transactionInfo);else for(var a=["currencyCode","countryCode","totalPrice"],s=0;s<a.length;s++){var d=a[s];d in t.button_configs.paymentRequest.transactionInfo||o.addParamIsMissing("button_configs.paymentRequest.transactionInfo."+d)}else o.addParamIsMissing("button_configs.paymentRequest.transactionInfo");else o.addParamIsMissing("button_configs.paymentRequest");else o.addParamIsMissing("button_configs");if(o.hasError())return console.error(o.buildInvalidParams()),o.buildInvalidParams();var _=new WePay._internal.wallet_iframe("Google Pay");return _.init(e,t,{iframe_route:"/paymentMethods/googlePay",initial_height:"100%",sandbox_enabled:!0,sandbox_attributes:"allow-forms allow-scripts allow-same-origin allow-popups"}),delete _.test,_},WePay.createApplePayIframe=WePay.createApplePayIframe||function(e,r){var t=r||{},n=WePay._internal.validateSDKIsConfigured();if(n.hasError())return n.buildSDKConfigurationError();var o=new WePay._internal.errorCollection;if("string"!=typeof e&&o.addWrongStringTypeError("iframe_container_id",e),document.getElementById(e)||o.addIDNotFoundError("iframe_container_id",e),"object"!=typeof t)o.addWrongObjectTypeError("iframeConfigs",t);else for(var i in t)t.hasOwnProperty(i)&&WePay._internal.allowOptions(i,["button_configs","on_success","on_error","on_cancel","on_update_payment_data"]);if(t.button_configs?"object"!=typeof t.button_configs?o.addWrongObjectTypeError("button_configs",t.button_configs):t.button_configs.accountId?"string"!=typeof t.button_configs.accountId?o.addWrongStringTypeError("button_configs.accountId",t.button_configs.accountId):t.button_configs.paymentRequest?"object"!=typeof t.button_configs.paymentRequest&&o.addWrongObjectTypeError("button_configs.paymentRequest",t.button_configs.paymentRequest):o.addParamIsMissing("button_configs.paymentRequest"):o.addParamIsMissing("button_configs.accountId"):o.addParamIsMissing("button_configs"),o.hasError())return console.error(o.buildInvalidParams()),o.buildInvalidParams();var a=new WePay._internal.wallet_iframe("Apple Pay");return a.init(e,t,{iframe_route:"/paymentMethods/applePay",initial_height:"100%",sandbox_enabled:!0,sandbox_attributes:"allow-forms allow-scripts allow-same-origin allow-popups"}),delete a.test,a},WePay.createKycIframe=WePay.createKycIframe||function(e,r){var t=WePay._internal.validateSDKIsConfigured(),n=["US","CA"];if(t.hasError())return t.buildSDKConfigurationError();var o=new WePay._internal.errorCollection;if("string"!=typeof e&&o.addWrongStringTypeError("iframe_container_id",e),document.getElementById(e)||o.addIDNotFoundError("iframe_container_id",e),r)if("object"!=typeof r)o.addWrongObjectTypeError("options",r);else if(r.country_code)if("string"!=typeof r.country_code)o.addWrongStringTypeError("options.country_code",r.country_code);else if(-1==n.indexOf(r.country_code))o.addParamValueIsInvalidEnumError("options.country_code",n);else for(var i in r)r.hasOwnProperty(i)&&WePay._internal.allowOptions(i,["custom_style","country_code","ssn4_enabled"]);else o.addParamIsMissing("options.country_code");else o.addParamIsMissing("options");if(o.hasError())return o.buildInvalidParams();var a=new WePay._internal.iframe;return a.init(e,r,{iframe_route:"/kyc/web_view/v3",initial_height:"800px"}),delete a.test,a},WePay.createPayoutIframe=WePay.createPayoutIframe||function(e,r){var t=WePay._internal.validateSDKIsConfigured();if(t.hasError())return t.buildSDKConfigurationError();var n=new WePay._internal.errorCollection;if("string"!=typeof e&&n.addWrongStringTypeError("iframe_container_id",e),document.getElementById(e)||n.addIDNotFoundError("iframe_container_id",e),r)if(r!==Object(r))n.addWrongObjectTypeError("options",r);else if(r.country_code)if("string"!=typeof r.country_code)n.addWrongStringTypeError("options.country_code",r.country_code);else if("US"!==r.country_code&&"CA"!=r.country_code)n.addParamValueIsInvalidEnumError("options.country_code",["US","CA"]);else for(var o in r)r.hasOwnProperty(o)&&WePay._internal.allowOptions(o,["country_code","custom_style"]);else n.addParamIsMissing("options.country_code");else n.addParamIsMissing("options");if(n.hasError())return n.buildInvalidParams();var i=new WePay._internal.iframe;return i.init(e,r,{initial_height:"500px",iframe_route:"/payouts/addBank/tokenize"}),delete i.test,i},WePay.tokens=WePay.tokens||{},WePay.tokens.create=WePay.tokens.create||function(e,r,t){return WePay._internal.makeJSONRequest("general","/tokens","POST",e,r,t)},WePay.documents=WePay.documents||{},WePay.documents.create=WePay.documents.create||function(e,r,t){return WePay._internal.makeFormRequest("upload","/documents","POST",e,r,t)},WePay.tags=WePay.tags||{device_token:0,uuid:function(){for(var e=[],r="0123456789abcdef",t=0;t<36;t++)e[t]=r.substr(Math.floor(16*Math.random()),1);return e[14]="4",e[19]=r.substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-",e.join("")},generate:function(e){var r=document.createElement("div"),t=document.createElement("div"),n=document.createElement("img"),o=document.createElement("script"),i=document.createElement("object"),a=document.createElement("param"),s=document.createElement("div");return r.id="WePay-tags",r.style.position="absolute",r.style.left="-1000px",r.style.maxHeight="0px",r.style.overflow="hidden",r.ariaHidden="true",t.style.background="url('https://t.wepay.com/fp/clear.png?org_id=ncwzrc4k&session_id="+e+"&m=1')",n.src="https://t.wepay.com/fp/clear.png?org_id=ncwzrc4k&session_id="+e+"&m=2",n.alt="",o.src="https://t.wepay.com/fp/check.js?org_id=ncwzrc4k&session_id="+e,o.type="text/javascript",o.async="true",i.type="application/x-shockwave-flash",i.data="https://t.wepay.com/fp/fp.swf?org_id=ncwzrc4k&session_id="+e,i.width=1,i.height=1,i.id="obj_id",a.name="movie",a.value="https://t.wepay.com/fp/fp.swf?org_id=ncwzrc4k&session_id="+e,i.appendChild(a),i.appendChild(s),i.ariaHidden="true",r.appendChild(t),r.appendChild(n),r.appendChild(o),r.appendChild(i),r},enable_device:function(e){this.device_token=e},insert:function(e){return e=e||this.device_token||WePay.tags.uuid(),document.getElementById("WePay-tags")||document.body.appendChild(WePay.tags.generate(e)),e}},WePay.createPaymentBankLightBox=WePay.createPaymentBankLightBox||function(e,r){r=r||{};var t=WePay._internal.validateSDKIsConfigured();if(t.hasError())return t.buildSDKConfigurationError();var n=new WePay._internal.errorCollection;if("object"!=typeof r)n.addWrongObjectTypeError("options",r);else for(var o in r)r.hasOwnProperty(o)&&WePay._internal.allowOptions(o,["avoid_micro_deposits"]);if(n.hasError())return n.buildInvalidParams();var i=new WePay._internal.light_box;return i.init(WePay._internal.plaidEventHandler,e,r,{iframe_route:"/paymentMethods/bankAccount",sandbox_enabled:!0,sandbox_attributes:"allow-forms allow-scripts allow-same-origin"}),delete i.test,i},WePay._internal=WePay._internal||new function(){var a={},e=this;return this.setAppID=function(e){a.app_id=e},this.setAPIVersion=function(e){a.api_version=e},this.setSessionToken=function(e){a.session_token=e},this.endpointsMapper=function(e){return{general:a.endpoint,upload:a.upload_endpoint,iframe:a.iframe_endpoint}[e]},this.setEnvironment=function(e){switch(a.environment=e){case"stage":a.endpoint=WePay.STAGING_ENDPOINT,a.upload_endpoint=WePay.STAGING_UPLOAD_ENDPOINT,a.iframe_endpoint=WePay.STAGE_IFRAME_ENDPOINT;break;case"production":a.endpoint=WePay.PRODUCTION_ENDPOINT,a.upload_endpoint=WePay.PRODUCTION_UPLOAD_ENDPOINT,a.iframe_endpoint=WePay.PRODUCTION_IFRAME_ENDPOINT}},this.getAppID=function(){return a.app_id},this.getAPIVersion=function(){return a.api_version},this.getSessionToken=function(){return a.session_token},this.validateSDKIsConfigured=function(){return this.validateSDKConfiguration(a.environment,a.app_id,a.api_version)},this.plaidErrorHandler=function(e){var r={error_code:"UNEXPECTED_ERROR",error_message:"There was an unknown error."},t={INVALID_CREDENTIALS:{error_code:"COULD_NOT_AUTHENTICATE",error_message:"The supplied credentials do not have permission to perform this action.",details:[{reason_code:"INVALID_CREDENTIALS",message:"The credentials provided are invalid. Please try again."}]},INVALID_MFA:{error_code:"COULD_NOT_AUTHENTICATE",error_message:"The supplied credentials do not have permission to perform this action.",details:[{reason_code:"INVALID_MFA",message:"MFA responses provided are invalid. Please try again."}]},ITEM_LOCKED:{error_code:"PAYMENT_METHODS_COULD_NOT_BE_RETRIEVED",error_message:"The payment methods could not be retrieved.",details:[{reason_code:"REJECTED_BY_ISSUING_BANK",message:"User account locked. Contact the financial institution to unlock."}]},ITEM_NOT_SUPPORTED:{error_code:"PAYMENT_METHODS_COULD_NOT_BE_RETRIEVED",error_message:"The payment methods could not be retrieved.",details:[{reason_code:"REJECTED_BY_ISSUING_BANK",message:"This account is restricted by the financial institution selected. User Account canâ€™t be supported by Plaid."}]},USER_SETUP_REQUIRED:{error_code:"PAYMENT_METHODS_COULD_NOT_BE_RETRIEVED",error_message:"The payment methods could not be retrieved.",details:[{reason_code:"USER_SETUP_REQUIRED",message:"Pending action with the financial institution. Please log in directly to resolve and then retry."}]},NO_ACCOUNTS:{error_code:"PAYMENT_METHODS_COULD_NOT_BE_RETRIEVED",error_message:"The payment methods could not be retrieved.",details:[{reason_code:"NO_ACCOUNT_FOUND",message:"No matching accounts found."}]},NO_AUTH_ACCOUNTS:{error_code:"PAYMENT_METHODS_COULD_NOT_BE_RETRIEVED",error_message:"The payment methods could not be retrieved.",details:[{reason_code:"NO_AUTH_ACCOUNT_FOUND",message:"No valid checking or savings accounts found to retrieve routing numbers."}]},INSTITUTION_NOT_RESPONDING:{error_code:"PAYMENT_METHODS_COULD_NOT_BE_RETRIEVED",error_message:"The payment methods could not be retrieved.",details:[{reason_code:"INSTITUTE_NOT_RESPONDING",message:"No response from the financial institution. Please try again later."}]}};if(e.errorCode in t){var n=t[e.errorCode];r.error_code=n.error_code,r.error_message=n.error_message,r.details=JSON.parse(JSON.stringify(n.details))}return r},this.microDepositsErrorHandler=function(e){var r={error_code:"UNEXPECTED_ERROR",error_message:"There was an unknown error."},t={INVALID_EMAIL_TYPE:{error_code:"INVALID_PARAMS",error_message:"Invalid parameter(s).",details:[{reason_code:"PARAM_VALUE_IS_INVALID_PATTERN",message:"Expected a value matching the regular expression '^([^,:;=@\"'\\\\\\s()\\[\\]]+)+@([a-zA-Z0-9-]+\\.)+[a-zA-Z]{2,}$'."}]},INVALID_ACCOUNT_NUMBER:{error_code:"INVALID_PARAMS",error_message:"Invalid parameter(s).",details:[{reason_code:"PARAM_VALUE_IS_INVALID_PATTERN",message:"Expected a value matching the regular expression '^[0-9]{3,17}$'."}]},INVALID_ROUTING_NUMBER:{error_code:"INVALID_PARAMS",error_message:"Invalid parameter(s).",details:[{reason_code:"PARAM_VALUE_IS_INVALID_PATTERN",message:"Expected a value matching the regular expression '^[0-9]{9}$'."}]}};if(e.errorCode in t){var n=t[e.errorCode];r.error_code=n.error_code,r.error_message=n.error_message,r.details=JSON.parse(JSON.stringify(n.details))}return r},this.plaidEventHandler=this.plaidEventHandler||function(e){var r;try{r=e.data&&"string"==typeof e.data?JSON.parse(e.data):e.data}catch(e){return void console.log("Could not parse JSON")}var t="errorCode"in r,n=r.popup_closing,o={errorOccurred:void 0,popupClosing:n,response:void 0};return t&&(o.errorOccurred=!0,"happyPath"===r.flow?o.response=WePay._internal.plaidErrorHandler(r):"microdeposits"===r.flow?o.response=WePay._internal.microDepositsErrorHandler(r):o.response={error_code:"UNEXPECTED_ERROR",error_description:"There was an unknown error."}),n&&("error"in r&&"window_closed"===r.error?(o.errorOccurred=!0,o.response={error_code:"TOKEN_CANNOT_BE_CREATED",error_message:"Token cannot be created.",details:[{reason_code:"USER_CANCELED",message:"The user has canceled the action."}]}):(o.errorOccurred=!1,delete r.popup_closing,o.response=r)),o},this.makeBaseRequest=function(e,r,t,n,o){n=null!=o;var i=new XMLHttpRequest;return n&&(i.onreadystatechange=function(){4==this.readyState&&o(JSON.parse(this.responseText))}),i.open(t,this.endpointsMapper(e)+r,n),i.setRequestHeader("App-Id",a.app_id),i.setRequestHeader("Api-Version",a.api_version),this.getSessionToken()&&i.setRequestHeader("Session-Token",a.session_token),this.get_risk_token()&&i.setRequestHeader("WePay-Risk-Token",this.get_risk_token()),i},this.makeJSONRequest=function(e,r,t,n,o,i){var a=null!=i,s=this.validateSDKIsConfigured();if(s.hasError())return i?void i(s.buildSDKConfigurationError()):s.buildSDKConfigurationError();var d=this.makeBaseRequest(e,r,t,a,i);return d instanceof Error?d:(d.setRequestHeader("Content-Type","application/json"),this.setXhttpHeader(d,o),"POST"===t&&n?d.send(JSON.stringify(n)):d.send(),a?void 0:JSON.parse(d.responseText))},this.makeFormRequest=function(e,r,t,n,o,i){var a=null!=i,s=this.validateSDKIsConfigured();if(s.hasError())return i?void i(s.buildSDKConfigurationError()):s.buildSDKConfigurationError();var d=this.makeBaseRequest(e,r,t,a,i);if(this.setXhttpHeader(d,o),"POST"===t&&n){var _=new FormData;for(var c in n)_.append(c,n[c]);d.send(_)}else d.send();return a?void 0:JSON.parse(d.responseText)},this.setXhttpHeader=function(e,r){var t=["Content-Type","App-Id","App-Token","Api-Version","WePay-Risk-Token"];if(r)for(var n=Object.keys(r),o=0;o<n.length;o++)-1==t.indexOf(n[o])&&e.setRequestHeader(n[o],r[n[o]])},this.validateSDKConfiguration=function(e,r,t){var n=new WePay._internal.errorCollection;return void 0===r?n.addParamIsMissing("app_id"):"string"!=typeof r&&n.addWrongStringTypeError("app_id",r),void 0===e?n.addParamIsMissing("environment"):"string"!=typeof e?n.addWrongStringTypeError("environment",e):"stage"!==e&&"production"!=e&&n.addParamValueIsInvalidEnumError("environment",["stage","production"]),void 0===t?n.addParamIsMissing("api_version"):"string"!=typeof t&&n.addWrongStringTypeError("api_version",t),n},this.get_risk_token=function(){return WePay.tags.device_token},this.generate_risk_token=function(){var e=WePay.tags.insert();WePay.tags.enable_device.bind(WePay.tags,e)()},this.generate_risk_token_delayed=function(){setTimeout(e.generate_risk_token,5e3)},this.checkNested=function(e){for(var r=Array.prototype.slice.call(arguments,1),t=0;t<r.length;t++){if(!e||!e.hasOwnProperty(r[t]))return!1;e=e[r[t]]}return!0},this.errorCollection=function(){var t=[];return{hasError:function(){return 0!==t.length},buildInvalidParams:function(){return{error_code:"INVALID_PARAMS",error_message:"Invalid parameter(s).",details:t}},buildUnexpectedError:function(){return{error_code:"UNEXPECTED_ERROR",error_message:"There was an unknown error."}},buildSDKConfigurationError:function(){return{error_code:"INVALID_SDK_CONFIGURATION",error_message:"The application is not configured correctly.",details:t}},addParamIsMissing:function(e){t.push({target:e,target_type:"SDK_PARAMETER",reason_code:"PARAM_IS_MISSING",message:"A required parameter is missing."})},addParamValueIsInvalidEnumError:function(e,r){t.push({target:e,target_type:"SDK_PARAMETER",reason_code:"PARAM_VALUE_IS_INVALID_ENUM",message:"Expected value in [ "+r.join(", ")+" ]."})},addIDNotFoundError:function(e,r){t.push({target:e,target_type:"SDK_PARAMETER",reason_code:"ID_NOT_FOUND",message:"ID "+r+" not found."})},addWrongStringTypeError:function(e,r){t.push({target:e,target_type:"SDK_PARAMETER",reason_code:"PARAM_VALUE_IS_WRONG_TYPE",message:"Expected type in [ string ] but found type "+typeof r+"."})},addWrongObjectTypeError:function(e,r){t.push({target:e,target_type:"SDK_PARAMETER",reason_code:"PARAM_VALUE_IS_WRONG_TYPE",message:"Expected type in [ object ] but found type "+typeof r+"."})}}},this.allowOptions=function(e,r){return!!new Set(r).has(e)||(console.warn(e+" is not a supported property."),!1)},this.light_box=function(){var d={is_init:!1,iframe_route:void 0,iframe:void 0,light_box:void 0},_=function(){d.iframe_endpoint=WePay._internal.endpointsMapper("iframe"),d.ref_id=WePay.tags.uuid(),d.app_id=WePay._internal.getAppID(),d.api_version=WePay._internal.getAPIVersion();var e=encodeURIComponent(d.ref_id),r=encodeURIComponent(d.app_id),t=encodeURIComponent(d.api_version);d.iframe_src=d.iframe_endpoint+d.iframe_route+"?ref_id="+e+"&client_id="+r+"&api_version="+t,d.iframe_src+="&light_box=true",d.iframe_src+="&v3=true",d.avoid_micro_deposits&&(console.log("info","avoid micro deposits"),d.iframe_src+="&avoidMicrodeposits=true")},t=function(e){if(e.origin===d.iframe_endpoint){var r=d.event_handler(e);!0===r.popupClosing?(document.body.removeChild(d.light_box),window.removeEventListener?window.removeEventListener("message",t):window.detachEvent&&window.detachEvent("message",t),!0===r.errorOccurred?d.promise_map.reject(r.response):d.promise_map.resolve(r.response)):!1===r.popupClosing&&d.internal_events_listener&&d.internal_events_listener(r.response)}else console.log("message is ignored, origin:%s, data:%s",e.origin,e.data)}.bind(this);window.addEventListener?window.addEventListener("message",t,!1):window.attachEvent&&window.attachEvent("message",t,!1);return{init:function(e,r,t,n){d.is_init||(d.is_init=!0,d.iframe_route=n.iframe_route,d.event_handler=e,d.internal_events_listener=r,d.avoid_micro_deposits=t.avoid_micro_deposits);var o="height: 665px;";t.hasOwnProperty("avoid_micro_deposits")&&t.avoid_micro_deposits&&screen.width<400&&(o="height: 550px;");var i="position: absolute; top: 0; width:360px; border: 0; left: 50%; margin-left: -180px; border-radius: 8px; margin-top: 30px;"+o;_();var a=document.createElement("iframe");a.setAttribute("name","paymentBankIFrame"),a.setAttribute("id","paymentBankIFrame"),a.setAttribute("style",i),a.src=d.iframe_src;var s=document.createElement("div");s.setAttribute("style","z-index: 2000; position: fixed; top: 0; left: 0; bottom: 0; right: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.6); overflow: scroll;"),s.appendChild(a),s.setAttribute("id","paymentBankLightBox"),d.iframe=a,d.light_box=s,document.body.appendChild(s)},tokenize:function(){return new Promise(function(e,r){d.promise_map={resolve:e,reject:r}})},test:function(){var e={_eventListener:t};return Object.assign(e,d)}}},this.iframe=function(){var a={is_init:!1,iframe_id:void 0,promise_map:{},custom_style:void 0,show_labels:void 0,show_placeholders:void 0,show_error_messages:void 0,show_error_messages_when_unfocused:void 0,show_error_icon:void 0,show_required_asterisk:void 0,resize_on_error_message:void 0,custom_required_field_error_message:void 0,use_one_liner:void 0,country_code:void 0,promise_count:0,iframe_endpoint:void 0,iframe_route:void 0,iframe_container_id:void 0},o=function(e){if(e.origin===a.iframe_endpoint){var r=e.data,t=r.promise_count;if(null==t||null!=a.promise_map[t])if("wepay-token"===r.event_id&&r.ref_id===a.ref_id&&null!=r.data)a.promise_map[e.data.promise_count].resolve(r.data),delete a.promise_map[e.data.promise_count];else if("wepay-token"===r.event_id&&r.ref_id===a.ref_id&&null!=r.error)a.promise_map[e.data.promise_count].reject(r.error),delete a.promise_map[e.data.promise_count];else{if("wepay-style"===r.event_id&&r.ref_id===a.ref_id&&null!=r.error)throw r.error;"wepay-resize"===r.event_id&&r.ref_id===a.ref_id?(a.iframe.style.height=r.height,r.event_id="wepay-resize-acknowledged",a.iframe.contentWindow.postMessage(r,a.iframe_src)):"closeCAEcheckIframe"===r.message&&document.body.removeChild(document.getElementById("paymentBankLightBox"))}}}.bind(this),i=function(){a.iframe_endpoint=WePay._internal.endpointsMapper("iframe"),a.ref_id=WePay.tags.uuid(),a.app_id=WePay._internal.getAppID(),a.api_version=WePay._internal.getAPIVersion();var e=encodeURIComponent(a.ref_id),r=encodeURIComponent(a.app_id),t=encodeURIComponent(a.api_version);a.iframe_src=a.iframe_endpoint+a.iframe_route+"?ref_id="+e+"&client_id="+r+"&api_version="+t,a.country_code&&(a.iframe_src+="&country="+a.country_code),!1===a.ssn4_enabled&&(a.iframe_src+="&ssn4_enabled=false"),!0===a.show_labels&&(a.iframe_src+="&show_labels=true"),!1===a.show_placeholders&&(a.iframe_src+="&show_placeholders=false"),!0===a.show_error_messages&&(a.iframe_src+="&show_error_messages=true"),!1===a.show_error_messages_when_unfocused&&(a.iframe_src+="&show_error_messages_when_unfocused=false"),!1===a.show_error_icon&&(a.iframe_src+="&show_error_icon=false"),!0===a.show_required_asterisk&&(a.iframe_src+="&show_required_asterisk=true"),!0===a.resize_on_error_message&&(a.iframe_src+="&resize_on_error_message=true"),a.custom_required_field_error_message&&(a.iframe_src+="&custom_required_field_error_message="+a.custom_required_field_error_message),!0===a.use_one_liner&&(a.iframe_src+="&use_one_liner=true");var n="#custom_style="+window.btoa(JSON.stringify(a.custom_style));a.custom_style&&a.iframe_src.length+n.length<2e3&&(a.iframe_src+=n)};return{init:function(e,r,t){if(!a.is_init){a.is_init=!0,a.iframe_container_id=e,a.iframe_id=e+"_iframe",a.custom_style=r&&r.custom_style?r.custom_style:null,a.iframe_route=t.iframe_route,a.country_code=r&&r.country_code?r.country_code:null,a.ssn4_enabled=!r||!1!==r.ssn4_enabled,a.show_labels=!(!r||!0!==r.show_labels),a.show_placeholders=!r||!1!==r.show_placeholders,a.show_error_messages=!(!r||!0!==r.show_error_messages),a.show_error_messages_when_unfocused=!r||!1!==r.show_error_messages_when_unfocused,a.show_error_icon=!r||!1!==r.show_error_icon,a.show_required_asterisk=!(!r||!0!==r.show_required_asterisk),a.resize_on_error_message=!(!r||!0!==r.resize_on_error_message),a.custom_required_field_error_message=r&&r.custom_required_field_error_message?r.custom_required_field_error_message:"",a.use_one_liner=!(!r||!0!==r.use_one_liner),a.sandbox_enabled=t.sandbox_enabled,a.sandbox_attributes=t.sandbox_attributes,i();var n=document.createElement("iframe");n.id=a.iframe_id,n.title="Credit Card Information Form",a.sandbox_enabled&&(n.sandbox=a.sandbox_attributes),a.iframe=n,a.iframe.style.border="none",a.iframe.style.width="100%",a.iframe.style.height=t.initial_height,a.iframe.src=a.iframe_src,document.getElementById(a.iframe_container_id).appendChild(a.iframe),a.iframe.addEventListener("load",function(){if(a.custom_style){var e={event_id:"wepay-style",ref_id:a.ref_id,data:{custom_style:a.custom_style}};a.iframe.contentWindow.postMessage(e,a.iframe_src)}window.addEventListener("message",o,!1)})}},tokenize:function(){var i=a.promise_count++;return new Promise(function(e,r){a.promise_map[i]={resolve:e,reject:r};var t={event_id:"wepay-tokenize",ref_id:a.ref_id,promise_count:i},n=document.getElementById(a.iframe_id);if(n)n.contentWindow.postMessage(t,a.iframe_src),setTimeout(function(){if(null!=a.promise_map[i]){var e=new WePay._internal.errorCollection;a.promise_map[i].reject(e.buildUnexpectedError()),delete a.promise_map[i]}},5e3);else{var o=new WePay._internal.errorCollection;o.addIDNotFoundError("iframe_id",a.iframe_id),o.hasError()&&a.promise_map[i].reject(o.buildInvalidParams())}})},setFocus:function(e){var r={event_id:"wepay-focus",ref_id:a.ref_id,input_key:e};["cc-number","cvv-number","expiration-month","expiration-year"].includes(r.input_key)?document.getElementById(a.iframe_id).contentWindow.postMessage(r,a.iframe_src):console.warn(r.input_key+" is not a supported key")},test:function(){var e={_receiveMessageHandler:o};return Object.assign(e,a)}}},this.wallet_iframe=function(i){function a(){return window.ApplePaySession?!!ApplePaySession.canMakePayments()||(console.log("Unable to create ApplePaySession, ApplePaySession.canMakePayments resolving to false"),!1):(console.log("Unable to create ApplePaySession, global ApplePaySession does not exist"),!1)}var _={is_init:!1,iframe_id:void 0,iframe_endpoint:void 0,iframe_route:void 0,iframe_container_id:void 0,button_configs:void 0,on_success:void 0,on_error:void 0,on_cancel:void 0},t=function(e,r,t){var n={shippingContact:e.shippingContact,paymentMethod:e.paymentMethod,shippingMethod:e.shippingMethod,couponCode:e.couponCode,updatedPaymentData:this.updatedPaymentData},o=_.on_update_payment_data(n)||{};try{if(o.errors){for(var i=[],a=0;a<o.errors.length;a++){var s=new ApplePayError(o.errors[a].code,o.errors[a].contactField,o.errors[a].message);i.push(s)}o.errors=i}r[t](o);var d=["newTotal","newLineItems","newShippingMethods","newRecurringPaymentRequest","newMultiTokenContexts","newAutomaticReloadPaymentRequest"].reduce(function(e,r){return e[r]=void 0===o[r]?n.updatedPaymentData[r]:o[r],e},{});this.updatedPaymentData.errors&&(d.errors=this.updatedPaymentData.errors),this.updatedPaymentData=d}catch(e){_.on_error(e)}}.bind(this),s=function(e,r){this.updatedPaymentData={},this.session=new ApplePaySession(e,r),this.session.onvalidatemerchant=function(e){_.iframe.contentWindow.postMessage({event_id:"wepay-onvalidate-merchant"},_.iframe_src)}.bind(this),this.session.onpaymentmethodselected=function(e){t(e,this.session,"completePaymentMethodSelection")}.bind(this),this.session.onshippingmethodselected=function(e){t(e,this.session,"completeShippingMethodSelection")}.bind(this),this.session.onshippingcontactselected=function(e){t(e,this.session,"completeShippingContactSelection")}.bind(this),this.session.oncouponcodechanged=function(e){t(e,this.session,"completeCouponCodeChange")}.bind(this),this.session.onpaymentauthorized=function(e){var r=e.payment.token,t={applePayToken:btoa(JSON.stringify({token:r}))};_.on_success(t),this.session.completePayment({status:this.session.STATUS_SUCCESS})}.bind(this),this.session.oncancel=function(e){_.on_cancel(e)}.bind(this),this.session.begin()}.bind(this),d=function(e){var r=e.data;if(r.ref_id===_.ref_id){var t=null!=r.data,n=null!=r.error;if("wepay-token"===r.event_id&&t)_.on_success(r.data);else if("wepay-token"===r.event_id&&n)_.on_error(r.error);else if("wepay-check-eligibility"===r.event_id)a()&&_.iframe.contentWindow.postMessage({event_id:"wepay-show-apple-pay-button"},_.iframe_src);else if("wepay-initialize-session"===r.event_id)a()&&s(r.data.webVersion,r.data.paymentRequest);else if("wepay-complete-validation"===r.event_id)this.session.completeMerchantValidation(r.data.paymentSession);else if("wepay-payment-data-update"===r.event_id&&t){var o=_.on_update_payment_data(r.data)||{},i={event_id:"wepay-payment-data-update",ref_id:_.ref_id,data:o};_.iframe.contentWindow.postMessage(i,_.iframe_src)}else"wepay-payment-data-update"===r.event_id&&n?_.on_error(r.error):"wepay-error"===r.event_id&&n?console.log(r.error):"wepay-payment-session-error"===r.event_id&&_.on_error(r.error)}}.bind(this),c=function(){_.iframe_endpoint=WePay._internal.endpointsMapper("iframe"),_.ref_id=WePay.tags.uuid(),_.app_id=WePay._internal.getAppID(),_.api_version=WePay._internal.getAPIVersion();var e=encodeURIComponent(_.ref_id),r=encodeURIComponent(_.app_id),t=encodeURIComponent(_.api_version);_.iframe_src=_.iframe_endpoint+_.iframe_route+"?ref_id="+e+"&client_id="+r+"&api_version="+t,_.account_id&&(_.iframe_src+="&account_id="+_.account_id)};return{init:function(e,r,t){var n=r||{};if(!_.is_init){_.is_init=!0,_.iframe_container_id=e,_.iframe_id=e+"_iframe",_.transaction_info=n.transaction_info,_.button_configs=n.button_configs||{},_.account_id=_.button_configs.accountId||null,_.iframe_route=t.iframe_route,_.country_code=n.country_code||null,_.sandbox_enabled=t.sandbox_enabled,_.sandbox_attributes=t.sandbox_attributes,_.on_success=n.on_success||function(){},_.on_error=n.on_error||function(){},_.on_cancel=n.on_cancel||function(){},_.on_update_payment_data=n.on_update_payment_data||function(){},c();var o=document.createElement("iframe");o.id=_.iframe_id,o.title=i,o.allow="payment *",_.sandbox_enabled&&(o.sandbox=_.sandbox_attributes),_.iframe=o,_.iframe.style.border="none",_.iframe.style.width="100%",_.iframe.style.height=t.initial_height,_.iframe.allowPaymentRequest=!0,_.iframe.src=_.iframe_src,document.getElementById(_.iframe_container_id).appendChild(_.iframe),_.iframe.addEventListener("load",function(){if(_.button_configs){var e={event_id:"wepay-button-configs",ref_id:_.ref_id,data:{button_configs:_.button_configs}};_.iframe.contentWindow.postMessage(e,_.iframe_src)}window.addEventListener("message",d,!1),_.iframe.contentWindow.postMessage({event_id:"wepay-js-listener-ready"},_.iframe_src)})}},test:function(){var e={_receiveMessageHandler:d};return Object.assign(e,_)}}},this},WePay.risk=WePay.risk||{},WePay.risk.generate_risk_token=WePay.risk.generate_risk_token||function(){WePay._internal.generate_risk_token()},WePay.risk.generate_risk_token_onload=WePay.risk.generate_risk_token_onload||function(){WePay._internal.generate_risk_token_delayed()},WePay.risk.get_risk_token=WePay.risk.get_risk_token||function(){return WePay._internal.get_risk_token()};try{window.addEventListener("load",WePay._internal.generate_risk_token_delayed,!1)}catch(e){window.attachEvent("onload",WePay._internal.generate_risk_token_delayed)}